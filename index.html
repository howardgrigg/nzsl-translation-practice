<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NZSL Translation Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .header p {
            font-size: 1.1em;
            color: #666;
        }

        .info-section {
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 0;
            background: #f9f9f9;
        }

        .info-section summary {
            padding: 15px;
            cursor: pointer;
            font-weight: 600;
            color: #2c3e50;
            background: #f9f9f9;
            border-radius: 8px;
            outline: none;
        }

        .info-section summary:hover {
            background: #f0f0f0;
        }

        .info-section p {
            padding: 0 15px 15px;
            margin: 0;
            font-size: 0.95em;
            line-height: 1.5;
        }

        .info-section a {
            color: #3498db;
            text-decoration: none;
        }

        .info-section a:hover {
            text-decoration: underline;
        }

        .video-container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .video-wrapper {
            position: relative;
            width: 100%;
            max-width: 480px;
            margin: 0 auto 20px;
            height: 360px; /* Fixed height to prevent jumping */
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            border-radius: 8px;
            overflow: hidden;
        }

        video {
            width: 100%;
            height: 100%;
            border-radius: 8px;
            background: #000;
            object-fit: contain;
        }

        .video-loading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            border-radius: 8px;
            z-index: 10;
        }

        .video-loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #e1e8ed;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        .video-loading-text {
            color: #666;
            font-size: 0.9em;
        }

        /* Prevent fullscreen video on mobile */
        video::-webkit-media-controls-fullscreen-button {
            display: none;
        }

        video::-webkit-media-controls {
            overflow: hidden;
        }

        /* Additional mobile video constraints */
        @media (max-width: 768px) {
            video {
                max-height: 300px;
                object-fit: contain;
            }
        }

        .video-info {
            text-align: center;
            margin-bottom: 20px;
            font-size: 0.9em;
            color: #666;
        }

        .input-section {
            margin-bottom: 20px;
        }

        .input-section label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        textarea {
            width: 100%;
            min-height: 100px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        .video-controls {
            display: flex;
            justify-content: center;
            margin-bottom: 15px;
        }

        .btn-speed {
            padding: 8px 16px;
            border: 2px solid #95a5a6;
            border-radius: 6px;
            background: white;
            color: #95a5a6;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-speed:hover {
            background: #95a5a6;
            color: white;
        }

        .btn-speed.slow {
            border-color: #e67e22;
            color: #e67e22;
        }

        .btn-speed.slow:hover {
            background: #e67e22;
            color: white;
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .btn-primary:disabled,
        .btn-disabled {
            background: #bdc3c7 !important;
            cursor: not-allowed;
        }

        .btn-success {
            background: #27ae60 !important;
            color: white;
        }

        .btn-success:hover {
            background: #229954 !important;
        }

        .results {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
            animation: slideInUp 0.5s ease-out;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .score {
            text-align: center;
            margin-bottom: 20px;
        }

        .score-number {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 5px;
            animation: bounceIn 0.8s ease-out;
        }

        .score-0-3 { color: #e74c3c; }
        .score-4-6 { color: #f39c12; }
        .score-7-8 { color: #f1c40f; }
        .score-9-10 { color: #27ae60; }

        .feedback {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            background: #f8f9fa;
            border-left: 4px solid #3498db;
        }

        .translations {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }

        .translation-box {
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #ecf0f1;
        }

        .translation-box h4 {
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .word-info {
            margin-top: 20px;
            padding: 15px;
            background: #e8f4f8;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            text-align: center;
        }

        .word-info .word-details {
            font-size: 0.9em;
            color: #555;
            margin-bottom: 10px;
        }

        .dictionary-link {
            display: inline-block;
            padding: 8px 16px;
            background: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            transition: background 0.3s;
        }

        .dictionary-link:hover {
            background: #2980b9;
            text-decoration: none;
        }

        .sign-sequence {
            margin: 15px 0;
            padding: 10px;
            background: #ecf0f1;
            border-radius: 6px;
            font-family: monospace;
            text-align: center;
            animation: fadeIn 0.6s ease-out;
        }

        .loading {
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Stats Display */
        .stats-display {
            background: #e8f4f8;
            border: 2px solid #3498db;
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .stats-summary {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 8px;
        }

        .stat-item {
            font-size: 0.9em;
            color: #2c3e50;
        }

        .improvement {
            font-size: 0.85em;
            font-weight: 600;
            margin-top: 5px;
        }

        .improvement.positive { color: #27ae60; }
        .improvement.negative { color: #e67e22; }
        .improvement.stable { color: #3498db; }

        .stats-text {
            color: #666;
            font-size: 0.9em;
        }

        /* Progress Section */
        .progress-section {
            margin-top: 30px;
        }

        .progress-actions {
            margin: 15px 0;
            text-align: center;
        }

        .btn-history {
            padding: 10px 20px;
            border: 2px solid #9b59b6;
            border-radius: 8px;
            background: white;
            color: #9b59b6;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-history:hover {
            background: #9b59b6;
            color: white;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 800px;
            max-height: 80vh;
            width: 100%;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
        }

        .modal-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-header h2 {
            margin: 0;
            color: #2c3e50;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            color: #333;
        }

        .btn-clear {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: background 0.3s;
        }

        .btn-clear:hover {
            background: #c0392b;
        }

        .history-list {
            max-height: 60vh;
            overflow-y: auto;
            padding: 20px;
        }

        .no-history {
            text-align: center;
            color: #666;
            padding: 40px 20px;
            font-style: italic;
        }

        .history-item {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background: #f9f9f9;
            transition: box-shadow 0.3s;
        }

        .history-item:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .history-word {
            font-weight: bold;
            font-size: 1.1em;
            color: #2c3e50;
        }

        .history-score {
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 4px;
            background: white;
        }

        .history-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.85em;
            color: #666;
            margin-bottom: 10px;
        }

        .history-translations {
            margin-bottom: 10px;
        }

        .history-user, .history-official {
            font-size: 0.9em;
            margin-bottom: 5px;
            padding: 8px;
            border-radius: 4px;
        }

        .history-user {
            background: #e3f2fd;
            border-left: 3px solid #2196f3;
        }

        .history-official {
            background: #f3e5f5;
            border-left: 3px solid #9c27b0;
        }

        .replay-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 600;
            transition: background 0.3s;
        }

        .replay-btn:hover {
            background: #2980b9;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .translations {
                grid-template-columns: 1fr;
            }

            .stats-summary {
                flex-direction: column;
                gap: 5px;
            }

            .modal {
                padding: 10px;
            }

            .modal-content {
                max-height: 90vh;
            }

            .history-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }

            .history-meta {
                flex-direction: column;
                gap: 2px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>NZSL Translation Practice</h1>
            <p>Watch the signed sentence and type your interpretation</p>
            
            <details class="info-section">
                <summary>About this application</summary>
                <p>This webapp uses video examples from the top 300 most common signs in New Zealand Sign Language (NZSL). Video examples are sourced from the <a href="https://nzsl.nz" target="_blank">NZSL.nz dictionary</a>, developed by the Deaf Studies Research Unit, Victoria University of Wellington.</p>
                <p>The list of most common signs is based on frequency analysis from: McKee, D., & Kennedy, G. D. (2006). The distribution of signs in New Zealand sign language. <em>Sign Language Studies</em>, <em>6</em>(4), 372-390.</p>
                <p>This tool was created by me, Howard Grigg, I'm based in Wellington and learning NZSL through evening classes. I built this primarily for my own practice but decided to publish it in case anyone else would find value from it. If you use this tool, I'd love to hear your feedback or even just a note to say you used it - email me at <a href="mailto:howard@gri.gg">howard@gri.gg</a>.</p>
                <p>This project is open source and available on <a href="https://github.com/howardgrigg/nzsl-translation-practice" target="_blank">GitHub</a> under the GPL v3 License. Feel free to contribute, report issues, or use it for your own learning!</p>
            </details>
        </div>

        <div class="video-container">
            <div class="video-wrapper">
                <div class="video-loading" id="videoLoading">
                    <div class="video-loading-spinner"></div>
                    <div class="video-loading-text">Loading video...</div>
                </div>
                <video id="signVideo" loop muted autoplay playsinline>
                    <source src="" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            
            <div class="video-info" id="videoInfo">
             </div>

            <div class="sign-sequence" id="signSequence" style="display: none;">
                <!-- Sign sequence will be shown here -->
            </div>

            <div class="input-section">
                <label for="userTranslation">Your interpretation:</label>
                <textarea 
                    id="userTranslation" 
                    placeholder="Type what you think the signed sentence means..."
                ></textarea>
            </div>

            <div class="video-controls">
                <button id="speedBtn" class="btn-speed">Normal Speed</button>
            </div>

            <div class="button-group">
                <button id="submitBtn" class="btn-primary">Submit Translation</button>
                <button id="nextBtn" class="btn-secondary">Next Video</button>
            </div>
        </div>

        <div id="results" class="results" style="display: none;">
            <div class="score">
                <div id="scoreNumber" class="score-number">-</div>
                <div>out of 10</div>
            </div>
            
            <div class="feedback" id="feedbackText">
                <!-- Feedback will appear here -->
            </div>

            <div class="translations">
                <div class="translation-box">
                    <h4>Your Translation</h4>
                    <div id="userTranslationDisplay"></div>
                </div>
                <div class="translation-box">
                    <h4>Official Translation</h4>
                    <div id="originalTranslationDisplay"></div>
                </div>
            </div>

            <div class="word-info" id="wordInfo">
                <!-- Word information and dictionary link will appear here -->
            </div>
        </div>

        <div id="loading" class="loading" style="display: none;">
            <div class="spinner"></div>
            <div>Scoring your translation...</div>
        </div>

        <!-- Progress Section -->
        <div class="progress-section">
            <div id="statsDisplay" class="stats-display">
                <div class="stats-text">Start practicing to see your progress!</div>
            </div>
            
            <div class="progress-actions">
                <button id="historyBtn" class="btn-history">üìö Practice History</button>
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div id="historyModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Practice History</h2>
                <div class="modal-actions">
                    <button id="clearHistoryBtn" class="btn-clear">üóëÔ∏è Clear All</button>
                    <button id="closeHistory" class="close-btn">&times;</button>
                </div>
            </div>
            <div id="historyList" class="history-list">
                <!-- History items will be populated here -->
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>