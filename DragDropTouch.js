/*! *****************************************************************************
* DragDropTouch: adds touch support to HTML5 drag/drop
* by Chris Bannon
* https://github.com/Bernardo-Castilho/dragdroptouch
***************************************************************************** */

/*!
 * DragDropTouch: HTML5 Drag and Drop for Mobile Devices
 * v1.3.1
 * https://github.com/Bernardo-Castilho/dragdroptouch
 * Copyright (c) Bernardo Castilho
 * MIT License
 */
!function(e){"use strict";var t,n,o,r,i,a;function u(e){for(var t=0;t<a.length;t++)if(a[t]==e)return!0;return!1}function l(e){return e&&e.touches?e.touches[0]:e}function c(e){return e.targetTouches?e.targetTouches[0]:e}function d(e){e.preventDefault(),e.stopPropagation()}function s(e){var t=e.dataTransfer;return t&&t.effectAllowed?t.effectAllowed:e.ctrlKey?"copy":"move"}function f(e,t){for(var n=e;n;n=n.parentNode)if(n==t)return!0;return!1}function g(e,t){for(var n=e;n;n=n.parentNode)if(n.draggable&&"false"!=n.draggable||n.hasAttribute&&n.hasAttribute("draggable")&&"false"!=n.getAttribute("draggable"))return n;return null}function h(e,t){var n=new Event(t,{bubbles:!0,cancelable:!0});return n.button=0,n.which=n.buttons=1,e&&(n.screenX=e.screenX,n.screenY=e.screenY,n.clientX=e.clientX,n.clientY=e.clientY),n}function v(e,t,n,o){var r=document.createEvent("DragEvent");return r.initDragEvent?r.initDragEvent(t,!0,!0,e.view,0,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null,n):((r=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,null),r.view=e.view,r.detail=0,r.screenX=e.screenX,r.screenY=e.screenY,r.clientX=e.clientX,r.clientY=e.clientY,r.ctrlKey=e.ctrlKey,r.altKey=e.altKey,r.shiftKey=e.shiftKey,r.metaKey=e.metaKey,r.button=0,r.buttons=1),r.dataTransfer=n,o&&(Object.defineProperty(r,"target",{value:o,enumerable:!0}),Object.defineProperty(r,"currentTarget",{value:o,enumerable:!0}),Object.defineProperty(r,"srcElement",{value:o,enumerable:!0})),r}function p(e){var n=e.dataTransfer,o=n.files||[],r=[];if(o.length)for(var i=0;i<o.length;i++)r.push(o[i].type);else{try{var a=n.getData("Text");a&&r.push("text/plain")}catch(e){}try{var u=n.getData("text/html");u&&r.push("text/html")}catch(e){}}return t._customDataTransfer?n:r.indexOf("text/html")>-1?"text/html":r.indexOf("text/plain")>-1?"text/plain":r.indexOf("text")>-1?"text":r.length?r[0]:"text"}function m(e,t){return"dataTransfer"==e?"dataTransfer":"dragDrop"==t||"dragEnter"==t||"dragLeave"==t||"dragOver"==t||"drag"==t||"drop"==t}function y(){return a.length}var E=function(){function e(){var e=this;this._lastClick=0,this._dragSource=null,this._dropTarget=null,this._dragImage=null,this._lastTarget=null,this._ptDown=null,this._dnDEnabled=!0,this._pressHoldMode=!1,this._pressHoldInterval=400,this._pressHoldTimer=null,this._pressHoldStart=null,this._data={},this._img=null,navigator.maxTouchPoints&&navigator.maxTouchPoints>1&&(this._dnDEnabled=!1),a=[],a.push(this),this._touchstart=this._touchstart.bind(this),this._touchmove=this._touchmove.bind(this),this._touchend=this._touchend.bind(this),this._touchcancel=this._touchcancel.bind(this),document.addEventListener("touchstart",this._touchstart,{passive:!1,capture:!1}),document.addEventListener("touchmove",this._touchmove,{passive:!1,capture:!1}),document.addEventListener("touchend",this._touchend,{passive:!1}),document.addEventListener("touchcancel",this._touchcancel,{passive:!1})}return Object.defineProperty(e.prototype,"dataTransfer",{get:function(){return this._dataTransfer||(this._dataTransfer=new DataTransfer)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pressHoldMode",{get:function(){return this._pressHoldMode},set:function(e){this._pressHoldMode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pressHoldInterval",{get:function(){return this._pressHoldInterval},set:function(e){this._pressHoldInterval=e},enumerable:!0,configurable:!0}),e.prototype._touchstart=function(e){var t=this;if(this._shouldHandle(e)){var n=l(e);this._reset(),this._pressHoldMode&&(this._pressHoldStart=Date.now(),this._pressHoldTimer=setTimeout(function(){t._pressHoldTimer=null,t._touchstart(e)},this._pressHoldInterval)),this._ptDown=n,this._lastClick=Date.now(),this._dragSource=g(e.target,e.currentTarget),this._dragSource&&(this._lastTarget=e.target,d(e))}},e.prototype._touchmove=function(e){var t=this;if(this._shouldHandle(e)){var n=l(e),o=this._ptDown,r=n.clientX-o.clientX,i=n.clientY-o.clientY;if(this._pressHoldMode&&!this._pressHoldTimer){var a=Date.now()-this._pressHoldStart;a<this._pressHoldInterval||(this._dispatchEvent(e,"dragstart",this._dragSource)&&(this._dragImage=this._createDragImage(n,this._dragSource),this._dispatchEvent(e,"dragenter",document.elementFromPoint(n.clientX,n.clientY))))}if(this._dragImage&&this._shouldCancelPressHoldMove(r,i)&&(this._reset(),this._pressHoldMode&&(this._pressHoldTimer=setTimeout(function(){t._pressHoldTimer=null,t._touchstart(e)},this._pressHoldInterval))),this._dragImage){d(e),this._lastTarget=document.elementFromPoint(n.clientX,n.clientY),this._lastTarget!=this._dropTarget&&(this._dispatchEvent(e,"dragleave",this._dropTarget),this._dispatchEvent(e,"dragenter",this._lastTarget),this._dropTarget=this._lastTarget),this._dispatchEvent(e,"dragover",this._dropTarget);var u=this._dragImage.style;u.position="absolute",u.pointerEvents="none",u.zIndex="999999",u.left=Math.round(n.clientX-this._ptDown.clientX+this._rect.left)+"px",u.top=Math.round(n.clientY-this._ptDown.clientY+this._rect.top)+"px"}}},e.prototype._touchend=function(e){this._shouldHandle(e)&&(this._pressHoldTimer&&(clearTimeout(this._pressHoldTimer),this._pressHoldTimer=null),this._dragImage?(this._dispatchEvent(e,"dragleave",this._dropTarget),this._dispatchEvent(e,"drop",this._dropTarget),this._dispatchEvent(e,"dragend",this._dragSource),this._reset()):this._dragSource&&(this._dragImage||this._dispatchEvent(e,"dragstart",this._dragSource)&&this._dispatchEvent(e,"dragend",this._dragSource),this._reset()))},e.prototype._touchcancel=function(e){this._shouldHandle(e)&&(this._pressHoldTimer&&(clearTimeout(this._pressHoldTimer),this._pressHoldTimer=null),this._reset())},e.prototype._shouldHandle=function(e){return e&&!this._ignoreTouchContextMenu&&e.touches&&1==e.touches.length&&this._dnDEnabled},e.prototype._shouldCancelPressHoldMove=function(e,t){return this._pressHoldMode&&this._pressHoldTimer&&(Math.abs(e)>50||Math.abs(t)>50)},e.prototype._reset=function(){this._destroyDragImage(),this._dragSource=null,this._lastClick=0,this._lastTarget=null,this._ptDown=null,this._dropTarget=null,this._pressHoldStart=null,clearTimeout(this._pressHoldTimer),this._pressHoldTimer=null,this._data={}},e.prototype._createDragImage=function(e,t){var n=this._imgCustom||this._imgDefault;if(n){var o=t.getBoundingClientRect(),r=n.style;n.className="ddt-drag-image",r.position="absolute",r.pointerEvents="none",r.zIndex="999999",r.left=Math.round(e.clientX-o.left)+"px",r.top=Math.round(e.clientY-o.top)+"px",this._rect=o,document.body.appendChild(n)}return n},e.prototype._destroyDragImage=function(){this._dragImage&&this._dragImage.parentElement&&this._dragImage.parentElement.removeChild(this._dragImage),this._dragImage=null,this._imgCustom=null,this._imgDefault=null},e.prototype._dispatchEvent=function(e,t,n){if(n&&n!=this._lastTarget){var o=l(e),r=this.dataTransfer,i=!1;if(r){if("dragstart"==t){r.effectAllowed=s(e),r.setDragImage||(r.setDragImage=function(e,t,n){}),"dragstart"!=t||this._imgCustom||(this._imgDefault=this._createDefaultDragImage(n))}else if("drop"==t){r.dropEffect=s(e);"copy"!=r.dropEffect&&"move"!=r.dropEffect||(i=!0)}t=v(o,t,r,n)}return n.dispatchEvent(t),i}return!1},e.prototype._createDefaultDragImage=function(e){var t=e.cloneNode(!0);return t.style.transform="rotate("+(5*Math.random()-2.5)+"deg)",t},e}();function D(){t||(t=new E)}t=null,n=null,o=null,r=null,i=null,a=[],"undefined"!=typeof window&&"addEventListener"in window&&D()}();